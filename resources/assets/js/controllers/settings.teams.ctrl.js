'use strict'
module.exports = [
  '$rootScope', '$http', '$modal', function($rootScope, $http, $modal) {
    var init
    this.teams = []
    init = (function(_this) {
      return function() {
        _this.authUser = angular.copy($rootScope.authUser)
        return _this.loadTeams()
      }
    })(this)
    this.loadTeams = function() {
      return $http.get('/api/teams').success((function(_this) {
        return function(data) {
          return _this.teams = data.teams
        }
      })(this))
    }
    this.renameTeam = function(team) {
      var newName
      newName = prompt('New name for this team', team.name)
      if (!newName) {
        return
      }
      team.name = newName
      return $http.put('/api/teams/' + team.id, {
        name: newName
      })
    }
    this.openTeamUsers = function(team) {
      return $modal.open({
        template: require('../layouts/settings.teams.users.modal.html'),
        controller: require('./settings.teams.users.modal.ctrl.js'),
        controllerAs: 'ctrl',
        size: 'md',
        resolve: {
          team: function() {
            return team
          }
        }
      }).result.then(function(team) {
        return console.log(team)
      })
    }
    this.deleteTeam = (function(_this) {
      return function(team) {
        if (!confirm('Delete this team and all it\'s data?')) {
          return
        }
        $http["delete"]('/api/teams/' + team.id)
        return _.remove(_this.teams, team)
      }
    })(this)
    this.createTeam = function() {
      var teamName
      teamName = prompt('New team name?')
      return $http.post('/api/teams', {
        name: teamName
      }).success((function(_this) {
        return function(data) {
          return _this.teams = data.teams
        }
      })(this))
    }
    init()
  }
]

// ---
// generated by coffee-script 1.9.2
